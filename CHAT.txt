

###################################################################################################
###################################################################################################
###################################################################################################

El sistema no lineal del oscilador de Van der Pol forzado es un conjunto de dos ecuaciones diferenciales no 
lineales acopladas que describen el movimiento de un oscilador que experimenta una fuerza externa. El sistema 
se puede escribir como:
z1' = z2/ε
z2' = ε*[-z1 + z2 - (1/3)*(z2)^3 + u]

Tome el oscilador de van der Pol Forzado con entrada de control 𝑢(𝑡) e implemente una linealización 
en el punto de equilibrio Z̅=[00]𝑇.

###################################################################################################
###################################################################################################
###################################################################################################
Obtenga el espacio de estados y la función de transferencia por medio de la transformada de Laplace, para el sistema linealizado . crear un progrma en python para Implementar una simulación para una entrada tipo escalón unitario y analice su resultado en términos de estabilidad.
sistema linealizado: 
z1' = 1/ε * z2
z2' = -1/ε * z1 + u

###################################################################################################
###################################################################################################
###################################################################################################
TERC#$ PUNTO

Cierre el lazo de control para la función de transferencia linealizada a través del siguiente esquema.
la función de transferencia del sistema es :                                                          
        s 
----------------
   s^2 + 1                        .                                                                       v
								                                     					                         |
														                                                         |
														                                                         |
	    +-----------------+   	   +-------+      +----------+     +---------+
r-->|Retroalimecion|  e    |               |  u   |                    |      |		            |
        |         	                     |--->|Control|--->|Actuador|-->|Proceso|-->y      
        |      		                     |	       |               |	    |                    | 	     |                 |
       +-----------------+	      +-------+        +---------+      +---------+
           |         									                                                        |	   
           |               +----------+           +-------------+	                    |
           |	            |                   |		       |                         |	                    |
		   +<------|  Filtro       |<------| Sensores    |<---------+
				            |                   |		       | 		                 |
				           +----------+           +-------------+                                                               
Y estabilice el lazo con un controlador lineal algebraico, por ejemplo, un PID. Puede usar cualquier método de ajuste para obtener los parámetros de este controlador, para los bloques Actuador, Filtro , Sensores reemplace el valor con 1.
Diseñar el PID utilizando cualquier método de ajuste, como el método de ajuste de Ziegler-Nichols.
Crear un progama de python para visualizar estos resultados en el tiempo. graficar la fucnion de tranferencia en lazo cerrado, con el controlador diseñado.
###################################################################################################
###################################################################################################
###################################################################################################
Cuarto Punto 

Para el siguiente sistema en lazo cerrado (T(s)=(0.2383 s^3 + 0.5988 s^2 + 0.903 s)/(1.238 s^3 + 0.5988 s^2 + 1.903 s)), obtenga el rango de estabilidad para 𝐾 a través del criterio de Routh – Hurwitz. Haga una simulación con python donde tome los valores de 𝐾 para el caso estable, inestable y marginalmente estable. 

###################################################################################################
###################################################################################################
###################################################################################################
QUINTO 
Punto Para el siguiente sistema en lazo cerrado ((T(s)=(0.2383 s^3 + 0.5988 s^2 + 0.903 s)/(1.238 s^3 + 0.5988 s^2 + 1.903 s)), Construya el Lugar de las Raíces y analice el rango de estabilidad con esta representación. Crear un programa en python para encontrar los ceros y polos y visualizar los resultados. realizar un excelente Análisis y concluir.


###################################################################################################
###################################################################################################
###################################################################################################
Sextoimport 

numpy as np
import matplotlib.pyplot as plt
import control as ctl
num = [0.2383, 0.5988,0.903,0]
den = [1.238, 0.5988, 1.903,0]

T = ctl.tf(num, den)

print('Función de Transferencia en Lazo Cerrado:')
print(T)
t, y = ctl.step_response(T)


plt.plot(t[t<=30], y[t<=30])
plt.xlabel('Tiempo (s)')
plt.ylabel('Salida')
plt.title('Respuesta en Lazo Cerrado con Controlador PID')
plt.grid()
plt.show(). 

Crea un programa para encontrar una funcion de tranferencia parecida En base a la anterior simulacion,  Toma datos de entrada y salida 𝑢(𝑡), 𝑦(𝑡) de la simulación del sistema en lazo cerrado.  Realiza una identificación del sistema para encontrar una función de transferencia aproximada a partir de los datos de simulación únicamente. Plotear las 2 funciones de transferencia la original y la aproximada en funcion del tiempo. utilza la funcion "step_info"

Crea un programa para Realizar una identificación del sistema para encontrar una función de transferencia aproximada a partir de los datos de simulación únicamente. Plotear las 2 funciones de transferencia la original y la aproximada en funcion del tiempo.
Funcion de transferencia Original.
num = [0.2383, 0.5988,0.903,0]
den = [1.238, 0.5988, 1.903,0]

[0.19241603111866895,0.27557212057661484,0.3628598830526082,0.4486754402915369,0.5280259640739613,0.5967711257024702,0.6517910455432896,0.6910775623660141,0.71375052315955,0.720005117804912,0.7109998429846025,0.6886973344599474,0.6556719821366142,0.6148989294304932,0.5695388084988364,0.5227314783160049,0.4774102560892836,0.43614583490832326,0.40102644779601926,0.37357805914778475,0.35472561872496267,0.3447938619439719,0.34354391756117997,0.350240192181746,0.36374070720411594,0.38260329873023236,0.40519985101352346,0.4298309845151026,0.4548342998412269,0.478680307971487,0.5000514611656943,0.5179011372133289,0.5314909218781458,0.5404059862539479,0.5445496842538764,0.5441196326974935,0.539568432302323,0.531552811305108,0.5208753125902079,0.5084227063451109,0.4951051156887892,0.4817994279269903,0.46929997443067256,0.45827874918181827,0.44925665391424585,0.4425864597078703,0.4384474100723432,0.4368507015997744,0.43765449928257655,0.44058669892996677,0.44527335282128777,0.451270530671393,0.45809739055662985,0.46526836981931163,0.47232265364679227,0.4788494137192616,0.48450770290719836,0.4890403154492116,0.4922813472517669,0.4941575923396752,0.49468426727797593,0.49395584856766717,0.4921330269062815,0.48942692064813675,0.4860817480300415,0.4823571379049397,0.4785111702253729,0.4747850920414835,0.47139046633942616,0.4684992949205967,0.46623742821461484,0.4646813492152104,0.46385820887810947,0.46374880738926466,0.4642930681238025,0.46539744439526265,0.4669436358067458,0.4687979708901401,0.4708208329312299,0.4728755614540453,0.47483634615416875,0.4765947354047306,0.4780644995517395,0.47918471181648375,0.47992102898190664,0.4802652633241198,0.4802334308666867,0.47986253484973834,0.47920639475381654,0.4783308593115105,0.4773087471787917,0.47621484314238605,0.4751212438170943,0.474093298457504,0.4731863320059518,0.472443273269813,0.4718932455404001,0.4715511140797001,0.47141792821781153,0.47148214813298533,0.4717215097363297,0.47210535661684605,0.47259725604504293,0.47315771613223173,0.47374683226656533,0.4743267112172034,0.47486354873986375,0.47532926882055704,0.4757026674745663,0.47597003896431356,0.47612529530795655,0.476169619227991,0.47611071483374945,0.4759617383791322,0.47574000287735635,0.47546555512068484,0.4751597220830155,0.4748437164621321,0.4745373792054619,0.47425812140845786,0.4740201102327119,0.47383372473574176,0.4737052889518759,0.47363707230397256,0.47362753237001326,0.4736717628712527,0.4737621009458685,0.4738888425370735,0.47404101303739304,0.4742071419610152,0.47437599495669,0.47453722338151294,0.47468190029715346,0.47480292144630154,0.47489525984019304,0.4749560724006514,0.47498466608986295,0.474982338667444,0.47495211529635495,0.47489840646487663,0.474826615018774,0.4747427205459051,0.4746528680734603,0.4745629852638654,0.4744784483342679,0.4744038121240285,0.47434261446010084,0.47429725958115077,0.4742689802106157,0.47425787320535245,0.47426299978153613,0.4742825382987695,0.47431397556311916,0.4743543216174073,0.4744003329859542,0.47444873023862794,0.4744963973979688,0.4745405529630824,0.4745788849752825,0.47460964540713735,0.474631702028696,0.474644548619091,0.4746482768008866,0.4746435147629165,0.4746313396253587,0.4746131711461521,0.47459065486472,0.474565542654787,0.4745395780689179,0.4745143928818918,0.4744914199725225,0.474471826227087,0.4744564676068171,0.47444586699693264,0.4744402140351293,0.4744393848783207,0.4744429788649986,0.4744503683045018,0.47446075719148645,0.47447324450248435,0.4744868878628802,0.4745007637435836,0.47451402091261474,0.4745259245757069,0.4745358894361465,0.47454350073168877,0.47454852311307777,0.4745508979681987,0.47455073043025764,0.47454826780951115,0.4745438715384249,0.4745379849128656,0.4745310989502027,0.4745237185811545,0.4745163311653518,0.47450937899594114,0.47450323706464326,0.4744981969255351,0.474494457052986,0.4744921196640409,0.4744911935918533,0.47449160247361455,0.47449319726745776,0.4744957719460039,0.47449908113186495,0.474502858439563,0.4745068343614126,0.47451075267067544,0.47451438449976163,0.4745175394688525,0.4745200734749522,0.47452189298741937,0.4745229559192536,0.47452326934164824,0.4745228844730756,0.47452188949684737,0.4745204008392118,0.47451855357308814,0.47451649160273124,0.4745143582365555,0.4745122876754658,0.47451039784009197,0.4745087848407633,0.47450751926749546,0.47450664435190926,0.4745061759362509,0.4745061040826984,0.4745063960736507,0.47450700049380823,0.47450785204904017,0.4745088767651887,0.47450999722055226,0.47451113749609686,0.4745122275738055,0.4745132069717327,0.4745140274696934,0.47451465484751587,0.4745150696241041,0.4745152668463861,0.47451525502944464,0.474515054390416,0.47451469454765455,0.4745142118726209,0.47451364668521656,0.4745130404748468,0.47451243331093973,0.47451186158004405,0.4745113561543061,0.47451094106055447,0.4745106326828328,0.47451043949626737,0.4745103622985855,0.4745103948789961,0.4745105250436249,0.4745107359029217,0.4745110073196252,0.4745113174157362,0.47451164404290347,0.47451196613173224,0.4745122648506532,0.47451252452284587,0.4745127332689841,0.4745128833629671,0.47451297130616144,0.47451299764198507,0.4745129665461558,0.4745128852380371,0.47451276326496966,0.47451261171422954,0.47451244240647733,0.4745122671206429,0.4745120968936514,0.474511941429867,0.47451180864532033,0.4745117043613855,0.4745116321522709,0.47451159334108484,0.47451158713084396,0.4745116108499977,0.4745116602871018,0.47451173008631375,0.47451181417438903,0.4745119061907114,0.4745119998943653,0.47451208952605994,0.47451217010747854,0.4745122376660006,0.4745122893783272,0.4745123236319914,0.47451234000874215,0.4745123391980857,0.4745123228526731,0.47451229339960554,0.47451225382305434,0.4745122074338662,0.4745121576411435,0.4745121077392705,0.4745120607216748,0.474512019129964,0.4745119849441537,0.4745119595167141,0.47451194355028814,0.4745119371163383,0.4745119397097854,0.4745119503330145,0.4745119676014862,0.47451198986262005,0.47451201531960757,0.4745120421522906,0.47451206862815365,0.474512093197717,0.4745121145700845,0.4745121317659812,0.4745121441472111,0.4745121514229751,0.4745121536348319,0.47451215112319206,0.47451214447907475,0.4745121344853846,0.47451212205219845,0.4745121081504891,0.474512093748395,0.47451207975360754,0.47451206696474896,0.4745120560338088,0.47451204744085307,0.4745120414813709,0.4745120382658373,0.4745120377303771,0.47451203965685634,0.4745120437003206,0.47451204942145403,0.4745120563216498,0.4745120638783515,0.4745120715785284,0.47451207894845643,0.4745120855783691,0.4745120911409858,0.47451209540337747,0.474512098232086,0.47451209959181806,0.4745120995383931,0.47451209820690193,0.47451209579623255,0.474512092551225,0.47451208874374573,0.4745120846539123,0.4745120805525773,0.47451207668600076,0.4745120732634236,0.474512070448014,0.47451206835141313,0.47451206703187027,0.4745120664957436,0.4745120667019637,0.4745120675689154,0.47451206898310105,0.4745120708089013,0.474512072898748,0.4745120751030608,0.4745120772793775,0.47451207930020634,0.47451208105925025,0.4745120824757836,0.47451208349709134,0.4745120840990058,0.47451208428468744,0.474512084081885,0.4745120835389815,0.4745120827201763,0.4745120817001707,0.4745120805587217,0.4745120793754026,0.47451207822486263,0.4745120771728241,0.47451207627298647,0.4745120755649383,0.4745120750731075,0.47451207480671603,0.4745120747606481,0.47451207491709363,0.4745120752477985,0.4745120757167279,0.47451207628294706,0.4745120769035256,0.4745120775362904,0.4745120781422761,0.4745120786877549,0.4745120791457644,0.47451207949708774,0.4745120797306797,0.4745120798435641,0.47451207984025856,0.4745120797318056,0.4745120795345024,0.4745120792684372,0.4745120789559338,0.47451207862000855,0.47451207828293007,0.4745120779649571,0.4745120776833155,0.47451207745145146,0.47451207727858036,0.47451207716953064,0.47451207712486476,0.4745120771412437,0.4745120772119907,0.4745120773278017,0.47451207747754753,0.4745120776491085,0.4745120778301923,0.47451207800908457,0.4745120781752953,0.47451207832007164,0.47451207843675913,0.4745120785210037,0.47451207857079697,0.47451207858637784,0.47451207857000793,0.4745120785256481,0.47451207845856264,0.4745120783748833,0.4745120782811613,0.47451207818393687,0.47451207808934925,0.47451207800280687,0.4745120779287326,0.47451207787039107,0.4745120778298015,0.4745120778077337,0.47451207780377813,0.47451207781648075,0.47451207784352745,0.4745120778819624,0.47451207792842504,0.47451207797938844,0.47451207803138584,0.47451207808121215,0.4745120781260914,0.4745120781638023,0.47451207819275937,0.47451207821204866,0.4745120782214193,0.47451207822123687,0.4745120782124038,0.4745120781962558,0.4745120781744408,0.4745120781487919,0.4745120781212004,0.47451207809349694,0.47451207806734813,0.47451207804417217,0.47451207802507717,0.47451207801082357,0.4745120780018118,0.4745120779980913,0.47451207799939066,0.47451207800516354,0.47451207801464745,0.47451207802692885,0.4745120780410127,0.47451207805588846,0.47451207807059326,0.47451207808426377,0.4745120780961793,0.47451207810579143,0.47451207811274043,0.4745120781168594,0.47451207811816626,0.4745120781168454,0.474512078113221,0.4745120781077248,0.4745120781008599,0.4745120780931647,0.47451207808517654,0.47451207807740037,0.4745120780702813,0.4745120780641836,0.47451207805937645,0.4745120780560267,0.4745120780541987,0.4745120780538597,0.4745120780548909,0.4745120780571028,0.47451207806025303,0.4745120780640656,0.4745120780682508,0.4745120780725236,0.47451207807662055,0.4745120780803129,0.4745120780834179,0.4745120780858046,0.47451207808739737,0.47451207808817514,0.47451207808816753,0.47451207808744816,0.4745120780861266,0.474512078084338,0.47451207808223284,0.47451207807996654,0.4745120780776897,0.47451207807553936,0.47451207807363227,0.4745120780720597,0.4745120780708846,0.47451207807013984,0.47451207806983003,0.474512078069933,0.4745120780704041,0.47451207807118073,0.474512078072188,0.4745120780733441,0.47451207807456613,0.4745120780757748,0.4745120780768991,0.4745120780778798,0.4745120780786716,0.4745120780792447,0.4745120780795854,0.4745120780796949,0.4745120780795884,0.47451207807929235,0.47451207807884205,0.4745120780782789,0.47451207807764706,0.4745120780769908,0.47451207807635154,0.47451207807576595,0.474512078075264,0.47451207807486795,0.47451207807459156,0.47451207807444007,0.4745120780744111,0.4745120780744948,0.47451207807467566,0.47451207807493384,0.4745120780752467,0.4745120780755903,0.4745120780759414,0.47451207807627827,0.4745120780765821,0.47451207807683765,0.47451207807703444,0.47451207807716594,0.4745120780772305,0.47451207807723045,0.47451207807717194,0.4745120780770638,0.4745120780769171,0.4745120780767444,0.4745120780765582,0.47451207807637114,0.4745120780761943,0.47451207807603735,0.4745120780759079,0.47451207807581103,0.4745120780757495,0.47451207807572365,0.47451207807573176,0.4745120780757701,0.4745120780758338,0.4745120780759164,0.47451207807601126,0.4745120780761116,0.47451207807621093,0.47451207807630336,0.47451207807638407,0.4745120780764493,0.4745120780764966,0.47451207807652485,0.474512078076534,0.47451207807652546,0.4745120780765013,0.47451207807646445,0.47451207807641826,0.4745120780763664,0.4745120780763125,0.47451207807625995,0.47451207807621176,0.47451207807617046,0.4745120780761378,0.474512078076115,0.47451207807610246,0.4745120780760999,0.4745120780761067,0.47451207807612145,0.4745120780761426,0.4745120780761683,0.4745120780761965,0.47451207807622536,0.47451207807625306,0.47451207807627793,0.474512078076299,0.4745120780763152,0.47451207807632606,0.4745120780763314,0.4745120780763315,0.4745120780763267,0.4745120780763179,0.4745120780763059,0.47451207807629175,0.4745120780762765,0.4745120780762611,0.4745120780762466,0.4745120780762337,0.47451207807622303,0.47451207807621504,0.4745120780762099,0.4745120780762078,0.4745120780762085,0.4745120780762116,0.4745120780762168,0.4745120780762236,0.47451207807623136,0.4745120780762396,0.47451207807624773,0.4745120780762553,0.47451207807626195,0.47451207807626733,0.47451207807627116,0.47451207807627344,0.47451207807627416,0.47451207807627355,0.47451207807627155,0.4745120780762686,0.47451207807626483,0.47451207807626056,0.47451207807625617,0.47451207807625184,0.47451207807624796,0.4745120780762445,0.4745120780762418,0.47451207807623996,0.4745120780762389,0.4745120780762387,0.47451207807623924,0.47451207807624046,0.4745120780762421,0.4745120780762442,0.4745120780762465,0.47451207807624896,0.47451207807625123,0.4745120780762533,0.47451207807625506,0.47451207807625634,0.4745120780762572,0.4745120780762577,0.4745120780762577,0.47451207807625734,0.4745120780762566,0.4745120780762556,0.4745120780762544,0.4745120780762532,0.4745120780762519,0.4745120780762507,0.4745120780762497,0.4745120780762488,0.4745120780762481,0.47451207807624773,0.47451207807624757,0.47451207807624757,0.47451207807624785,0.47451207807624834,0.4745120780762489,0.47451207807624957,0.4745120780762502,0.4745120780762509,0.4745120780762515,0.474512078076252,0.4745120780762524,0.47451207807625273,0.4745120780762529,0.47451207807625295,0.47451207807625284,0.4745120780762527,0.47451207807625245,0.4745120780762522,0.47451207807625184,0.4745120780762515,0.4745120780762512,0.47451207807625084,0.4745120780762506,0.47451207807625034,0.4745120780762501,0.47451207807625007,0.47451207807625007,0.4745120780762502,0.47451207807625023,0.47451207807625034,0.47451207807625057,0.47451207807625073,0.474512078076251,0.474512078076251120780762516,0.47451207807625156,0.4745120780762515,0.4745120780762514,0.47451207807625134,0.47451207807625123,0.4745120780762511,0.47451207807625106,0.474512078076251]
realice una identificación del sistema para encontrar una función de transferencia aproximada a partir de los datos de simulación únicamente.




&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

Paso 1: Linealización del sistema
Dado el sistema con la función de transferencia linealizada:
G(s) = 1 / (s^2 + s)

Paso 2: Obtención de la forma canónica controlable
Convertimos la función de transferencia a la forma canónica controlable, que tiene la siguiente forma:

A = [[0, 1], [0, -1]]
B = [[0], [1]]
C = [[1, 0]]
D = [[0]]

Paso 3: Diseño del observador de Luenberger
Para diseñar el observador de Luenberger, necesitamos seleccionar los polos del observador, es decir, los valores propios deseados 
de la matriz A-LC, donde L es la ganancia del observador. Para este ejemplo, seleccionaremos polos en -2 y -3.

Los polos del observador se pueden obtener utilizando la función place() de la biblioteca de control en Python. Aquí hay un ejemplo
 de cómo calcular los polos del observador:

python
Copy code
import numpy as np
from scipy import signal

A = np.array([[0, 1], [0, -1]])
C = np.array([[1, 0]])
des_poles = np.array([-2, -3])

L = signal.place_poles(A.T, C.T, des_poles).gain_matrix.T
Esto nos dará la ganancia del observador L.

Paso 4: Diseño del controlador
El diseño del controlador se basa en la ley de control por realimentación de estados. Dado el controlador C(s) = (s^4 + 4.019s^3 + 4.02s^2 - 1) / (s^2 + s), necesitamos convertirlo a la forma de espacio de estados. Podemos hacerlo utilizando la función tf2ss() de la biblioteca de control:

python
Copy code
import numpy as np
from scipy import signal

num = [1, 4.019, 4.02, 0, -1]
den = [1, 1, 0]

A_c, B_c, C_c, D_c = signal.tf2ss(num, den)
Esto nos dará las matrices A_c, B_c, C_c, D_c del controlador en la forma de espacio de estados.

Paso 5: Cálculo de las ganancias del controlador
Para calcular las ganancias del controlador, necesitamos resolver la ecuación de Riccati asociada al sistema controlado. 
Podemos utilizar la función care() de la biblioteca de control para resolverla:

python
Copy code
import numpy as np
from scipy import signal

Q = np.eye(2)  # Matriz de ponderación de los estados
R = np.eye(1)  # Matriz de ponderación de la entrada

K, _, _ = signal.care(A, B, Q, R)
Esto nos dará la ganancia del controlador K.

En resumen, los resultados del diseño serían:

Ganancia del observador: L
Matrices del controlador: A_c, B_c, C_c, D_c
Ganancia del controlador: K
Estos valores se pueden utilizar para implementar el controlador por retroalimentación de estados con estimador de Luenberger en el 
sistema dado.